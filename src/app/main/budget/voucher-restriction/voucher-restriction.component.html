<div class="card px-4 pt-4 m-0">
  <p-toolbar styleClass="mb-4">
    <ng-template pTemplate="left">
      <h3 class="tab-name m-0">Voucher Restriction</h3>
    </ng-template>
    <ng-template pTemplate="right">
      <!-- <div class="p-toolbar-group-left">
        <div class="gap-3 flex">
          <span
            pButton
            style="height: 25px; width: 25px; cursor: pointer"
            icon="pi pi-plus-circle"
            class="p-button-success"
            (click)="show()"
          ></span>
          <span class="block md:mt-0 p-input-icon-left">
            <i class="pi pi-search"></i>
            <input
              pInputText
              type="text"
              (input)="onGlobalFilter(policyTable, $event)"
              placeholder="Search..."
              style="height: 25px; cursor: pointer"
            />
          </span>
        </div>
      </div> -->
      <div class="table-search-container">
        <span class="block md:mt-0 p-input-icon-left">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="text"
            (keydown.enter)="onEnter($event)"
            (input)="onGlobalFilter(policyTable, $event)"
            placeholder="Search..."
            class="globalSearchStyle"
          />
        </span>
        <div class="mt-0">
          <span
            pButton
            pRipple
            [rounded]="true"
            class="p-button-success"
            (click)="show()"
          >
          Create
        </span>
        </div>
      </div>
    </ng-template>
  </p-toolbar>
  <p-table
    #policyTable
    [value]="tableData"
    [loading]="loading"
    styleClass="p-datatable-gridlines"
    [scrollable]="true"
    scrollHeight="58vh"
    [rowHover]="true"
    responsiveLayout="scroll"
    [paginatorDropdownAppendTo]="'body'"
    dataKey="id"
    class="voucher-restriction-table"
    responsiveLayout="scroll"
    [style]="{ width: '100%', 'overflow-y': 'auto' }"
    [globalFilterFields]="[
      'name',
      'voucherPrefix',
      'creationRestrictionDate',
      'editRestrictionDate',
      'approvalRestrictionDate',
      'unapprovalRestrictionDate',
      'revisionRestrictionDate',
      'isCreationAllowed',
      'isEditAllowed',
      'isApprovalAllowed',
      'isUnapprovalAllowed',
      'isRevisionAllowed'
    ]"
  >
    <ng-template pTemplate="header">
      <tr>
        <th class="text-nowrap" title="Name" pSortableColumn="name">
          <div class="d-flex justify-content-between"><span class="th-data">
          Name </span><p-sortIcon field="name" />
          </div>
        </th>
        <th class="text-nowrap" title="Voucher Prefix" pSortableColumn="address">
          <div class="d-flex justify-content-between"><span class="th-data">
          Voucher Prefix</span><p-sortIcon field="address" />
          </div>
        </th>
        <th class="text-nowrap" title="Create Restriction Date" pSortableColumn="occupiedStatus">
          <div class="d-flex justify-content-between"><span class="th-data">
          Create Restriction Date</span><p-sortIcon field="occupiedStatus" />
          </div>
        </th>
        <th class="text-nowrap" title="Edit Restriction Date" pSortableColumn="occupiedStatus">
          <div class="d-flex justify-content-between"><span class="th-data">
          Edit Restriction Date </span><p-sortIcon field="occupiedStatus" />
          </div>
        </th>
        <th class="text-nowrap" title="Approve Restriction Date" pSortableColumn="occupiedStatus">
          <div class="d-flex justify-content-between"><span class="th-data">
          Approve Restriction Date</span><p-sortIcon field="occupiedStatus" />
          </div>
        </th>
        <th class="text-nowrap" title="UnApprove Restriction Date" pSortableColumn="description">
          <div class="d-flex justify-content-between"><span class="th-data">
          UnApprove Restriction Date </span><p-sortIcon field="description" />
          </div>
        </th>
        <th class="text-nowrap" title="Revision Restriction Date" pSortableColumn="isElectricityIncluded">
          <div class="d-flex justify-content-between"><span class="th-data">
          Revision Restriction Date </span><p-sortIcon field="isElectricityIncluded" />
          </div>
        </th>
        <th class="text-nowrap" title="Is creation Allowed" pSortableColumn="isGasIncluded">
          <div class="d-flex justify-content-between"><span class="th-data">
          Is creation Allowed </span><p-sortIcon field="isGasIncluded" />
          </div>
        </th>
        <th class="text-nowrap" title="Is edit Allowed" pSortableColumn="isGasIncluded">
          <div class="d-flex justify-content-between"><span class="th-data">
          Is edit Allowed </span><p-sortIcon field="isGasIncluded" />
          </div>
        </th>
        <th class="text-nowrap" title="Is approval Allowed" pSortableColumn="isGasIncluded">
          <div class="d-flex justify-content-between"><span class="th-data">
          Is approval Allowed</span> <p-sortIcon field="isGasIncluded" />
          </div>
        </th>
        <th class="text-nowrap" title="Is Unapproval Allowed" pSortableColumn="isGasIncluded">
          <div class="d-flex justify-content-between"><span class="th-data">
          Is Unapproval Allowed</span> <p-sortIcon field="isGasIncluded" />
          </div>
        </th>
        <th class="text-nowrap" title="Is Revision Allowed" pSortableColumn="isGasIncluded">
          <div class="d-flex justify-content-between"><span class="th-data">
          Is Revision Allowed </span><p-sortIcon field="isGasIncluded" />
          </div>
        </th>
        <th class="text-nowrap" title="Active" pSortableColumn="isActive">
          <div class="d-flex justify-content-between"><span class="th-data">
          Active </span><p-sortIcon field="isActive" />
          </div>
        </th>
        <th class="text-nowrap" title=" Actions" pSortableColumn="Actions">
          <div class="d-flex justify-content-between"><span class="th-data">
          Actions </span><p-sortIcon field="Actions" />
          </div>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item>
      <tr>
        <!-- <td class="flex justify-content-center">
          <span
            style="height: 35px; width: 35px; cursor: pointer"
            pButton
            pRipple
            icon="pi pi-pencil"
            class="p-bu p-button-info mr-2"
            (click)="show(item.id)"
          ></span>
          <span
            style="height: 35px; width: 35px; cursor: pointer"
            pButton
            pRipple
            icon="pi pi-trash"
            class="p- p-button-warning mr-2"
            (click)="delete(item.id)"
          ></span>
        </td> -->
        <td class="no-wrap-header" title="{{ item.name }}">{{ item.name }}</td>
        <td class="no-wrap-header" title="{{ item.voucherPrefix }}">{{ item.voucherPrefix }}</td>
        <td class="no-wrap-header" title="{{ item.creationRestrictionDate | date }}">{{ item.creationRestrictionDate | date }}</td>
        <td class="no-wrap-header" title="{{ item.editRestrictionDate | date }}">{{ item.editRestrictionDate | date }}</td>
        <td class="no-wrap-header" title="{{ item.approvalRestrictionDate | date }}">{{ item.approvalRestrictionDate | date }}</td>
        <td class="no-wrap-header" title="{{ item.unapprovalRestrictionDate | date }}">{{ item.unapprovalRestrictionDate | date }}</td>
        <td class="no-wrap-header" title="{{ item.revisionRestrictionDate | date }}">{{ item.revisionRestrictionDate | date }}</td>

        <td>
          <span *ngIf="item.isCreationAllowed" class="active-box">Yes</span>
          <span *ngIf="!item.isCreationAllowed" class="deactive-box">No</span>
        </td>
        <td>
          <span *ngIf="item.isEditAllowed" class="active-box">Yes</span>
          <span *ngIf="!item.isEditAllowed" class="deactive-box">No</span>
        </td>
        <td>
          <span *ngIf="item.isApprovalAllowed" class="active-box">Yes</span>
          <span *ngIf="!item.isApprovalAllowed" class="deactive-box">No</span>
        </td>
        <td>
          <span *ngIf="item.isUnapprovalAllowed" class="active-box">Yes</span>
          <span *ngIf="!item.isUnapprovalAllowed" class="deactive-box">No</span>
        </td>
        <td>
          <span *ngIf="item.isRevisionAllowed" class="active-box">Yes</span>
          <span *ngIf="!item.isRevisionAllowed" class="deactive-box">No</span>
        </td>
        <td>
          <span *ngIf="item.isActive" class="active-box">Yes</span>
          <span *ngIf="!item.isActive" class="deactive-box">No</span>
        </td>
        <td class="icon-group">
          <span (click)="show(item.id)" class="edit-btn">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_530_1269)">
                <path
                  d="M12.7146 4.5625L13.4081 3.86903C13.5213 3.75589 13.6111 3.62156 13.6723 3.47371C13.7336 3.32585 13.7651 3.16738 13.7651 3.00733C13.7651 2.84729 13.7336 2.68882 13.6723 2.54096C13.6111 2.39311 13.5213 2.25878 13.4081 2.14564L12.1197 0.857056C11.8911 0.628617 11.5811 0.500298 11.2579 0.500298C10.9347 0.500298 10.6247 0.628617 10.3961 0.857056L9.70264 1.55054L12.7146 4.5625Z"
                  fill="#019999" />
                <path
                  d="M9.12837 2.125L1.29061 9.96278C1.22851 10.0248 1.18821 10.1052 1.17576 10.1921L0.76533 13.0358C0.757082 13.0935 0.761311 13.1522 0.77773 13.2081C0.794149 13.2639 0.822375 13.3156 0.860499 13.3596C0.898622 13.4036 0.945753 13.4389 0.998704 13.4632C1.05165 13.4874 1.10919 13.4999 1.16742 13.5C1.1866 13.5001 1.20575 13.4987 1.22474 13.496L4.07266 13.0898C4.1597 13.0773 4.24036 13.0369 4.30255 12.9747L12.1403 5.13696L9.12837 2.125Z"
                  fill="#019999" />
              </g>
              <defs>
                <clipPath id="clip0_530_1269">
                  <rect width="13" height="13" fill="white" transform="translate(0.765137 0.5)" />
                </clipPath>
              </defs>
            </svg>
          </span>
          <span class="delete-btn mr-2" (click)="delete(item.id)">
            <svg width="15" height="19" viewBox="0 0 15 19" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M14.1401 2.75H10.7651V2.375C10.7651 1.34113 9.92401 0.5 8.89014 0.5H6.64014C5.60626 0.5 4.76514 1.34113 4.76514 2.375V2.75H1.39014C0.976137 2.75 0.640137 3.086 0.640137 3.5V4.625C0.640137 5.039 0.976137 5.375 1.39014 5.375H14.1401C14.5541 5.375 14.8901 5.039 14.8901 4.625V3.5C14.8901 3.086 14.5541 2.75 14.1401 2.75ZM6.26514 2.375C6.26514 2.16838 6.43351 2 6.64014 2H8.89014C9.09676 2 9.26514 2.16838 9.26514 2.375V2.75H6.26514V2.375Z"
                fill="#FF0000" />
              <path
                d="M13.8703 6.37063C13.7282 6.21425 13.5264 6.125 13.3153 6.125H2.2153C2.00418 6.125 1.80242 6.21425 1.6603 6.37063C1.51817 6.527 1.4488 6.73625 1.46867 6.94662L2.39042 16.5796C2.49505 17.6746 3.45842 18.5004 4.63142 18.5004H10.8992C12.0718 18.5004 13.0355 17.6746 13.1402 16.5796L14.0619 6.94662C14.0822 6.73625 14.0124 6.527 13.8703 6.37063ZM6.01255 16.6235C5.99643 16.6242 5.98067 16.625 5.96455 16.625C5.57192 16.625 5.24193 16.3197 5.2168 15.9222L4.7668 8.79725C4.74092 8.384 5.0548 8.02775 5.46805 8.0015C5.88243 7.979 6.23793 8.2895 6.2638 8.70275L6.7138 15.8277C6.73967 16.241 6.4258 16.5972 6.01255 16.6235ZM10.3138 15.9222C10.2887 16.3197 9.95867 16.625 9.56605 16.625C9.5503 16.625 9.53417 16.6246 9.51805 16.6235C9.10442 16.5972 8.79093 16.241 8.8168 15.8277L9.2668 8.70275C9.29305 8.28912 9.64742 7.97825 10.0625 8.0015C10.4762 8.02775 10.7897 8.384 10.7638 8.79725L10.3138 15.9222Z"
                fill="#FF0000" />
            </svg>
          </span>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <p-paginator
   class="mt-4"
    [rows]="10"
    [totalRecords]="this.count"
    (onPageChange)="this.onPageChange($event)"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [showCurrentPageReport]="true"
    [rowsPerPageOptions]="[10, 20, 50, this.count]"
  >
  </p-paginator>
</div>

<!-- Modal -->
<p-dialog
  [maximizable]="true"
  [closeOnEscape]="false"
  [header]="
    editMode ? 'Edit Voucher Restriction' : 'Create Voucher Restriction'
  "
  [modal]="true"
  [(visible)]="displayModal"
  class="voucher-restriction-modal"
  [draggable]="false"
  style="width: 800vh"
>
  <ng-container>
    <form [formGroup]="rentalhouseform" (ngSubmit)="save()">
      <div class="row">
        <div id="inputField" class="col-md-12 flex flex-column">
          <label for="name">Name:</label>
          <input
            type="text"
            pInputText
            formControlName="name"
            id="name"
            autocomplete="off"
          />
        </div>
        <div id="inputField" class="col-md-6 flex flex-column p-field mt-3">
          <label for="name">Voucher Prefex:</label>
          <input
            type="text"
            class="p-field"
            pInputText
            formControlName="voucherPrefix"
            id="voucherPrefix"
            autocomplete="off"
          />
        </div>
        <div class="flex flex-column p-field mt-3 col-md-6">
          <label for="date">Create Date</label>
          <p-calendar
            formControlName="creationRestrictionDate"
            inputId="date"
            appendTo="body"
            tabindex="1"
            [showTime]="true"
            hourFormat="24"
            [showOnFocus]="true"
          ></p-calendar>
        </div>
        <div class="flex flex-column p-field mt-3 col-md-6">
          <label for="date">Edit Date</label>
          <p-calendar
            formControlName="editRestrictionDate"
            inputId="date"
            appendTo="body"
            tabindex="1"
            [showTime]="true"
            hourFormat="24"
            [showOnFocus]="true"
          ></p-calendar>
        </div>
        <div class="flex flex-column p-field mt-3 col-md-6">
          <label for="date">Approval Date</label>
          <p-calendar
            formControlName="approvalRestrictionDate"
            inputId="date"
            appendTo="body"
            tabindex="1"
            [showTime]="true"
            hourFormat="24"
            [showOnFocus]="true"
          ></p-calendar>
        </div>
        <div class="flex flex-column p-field mt-3 col-md-6">
          <label for="date">UnApproval Date</label>
          <p-calendar
            formControlName="unapprovalRestrictionDate"
            inputId="date"
            appendTo="body"
            tabindex="1"
            [showTime]="true"
            hourFormat="24"
            [showOnFocus]="true"
          ></p-calendar>
        </div>
        <div class="flex flex-column p-field mt-3 col-md-6">
          <label for="date">Revision Date</label>
          <p-calendar
            formControlName="revisionRestrictionDate"
            inputId="date"
            appendTo="body"
            tabindex="1"
            [showTime]="true"
            hourFormat="24"
            [showOnFocus]="true"
          ></p-calendar>
        </div>
      </div>
      <div class="row flex-column gap-2 mt-3">
        <div class="d-flex align-items-center gap-3">
          <div class="flex align-items-center gap-2">
            <p-checkbox
              formControlName="isCreationAllowed"
              [binary]="true"
              inputId="isCreationAllowed"
            />
            <label for="isCreationAllowed" class="mb-0">IsCreationAllowed</label>
          </div>
          
          <div class="flex align-items-center gap-2">
            <p-checkbox
              formControlName="isEditAllowed"
              [binary]="true"
              inputId="isEditAllowed"
            />
            <label for="isEditAllowed" class="mb-0">IsEditAllowed</label>
          </div>
        </div>
        <div class="d-flex align-items-center gap-3">
          <div class="flex align-items-center gap-2">
            <p-checkbox formControlName="isApprovalAllowed" [binary]="true" inputId="isApprovalAllowed" />
            <label for="isApprovalAllowed" class="mb-0">IsApprovalAllowed</label>
          </div>
        
          <div class="flex align-items-center gap-2">
            <p-checkbox formControlName="isUnapprovalAllowed" [binary]="true" inputId="isUnapprovalAllowed" />
            <label for="isUnapprovalAllowed" class="mb-0">IsUnapprovalAllowed</label>
          </div>
        </div>
       
        <div class="flex align-items-center gap-2">
          <p-checkbox
            formControlName="isRevisionAllowed"
            [binary]="true"
            inputId="isRevisionAllowed"
          />
          <label for="isRevisionAllowed" class="mb-0">IsRevisionAllowed</label>
        </div>
        
      </div>
      <!-- <div class="row col-md-12 mt-3">
        <div class="flex align-items-center gap-2">
          <p-checkbox
            formControlName="isActive"
            [binary]="true"
            inputId="active"
          />
          <label for="active" class="mb-0">Active</label>
        </div>
        <div class="flex align-items-center gap-2">
          <p-checkbox
            formControlName="isCreationAllowed"
            [binary]="true"
            inputId="isCreationAllowed"
          />
          <label for="isCreationAllowed" class="mb-0">IsCreationAllowed</label>
        </div>
        <div class="flex align-items-center gap-2">
          <p-checkbox
            formControlName="isEditAllowed"
            [binary]="true"
            inputId="isEditAllowed"
          />
          <label for="isEditAllowed" class="mb-0">IsEditAllowed</label>
        </div>
        <div class="flex align-items-center gap-2">
          <p-checkbox
            formControlName="isApprovalAllowed"
            [binary]="true"
            inputId="isApprovalAllowed"
          />
          <label for="isApprovalAllowed" class="mb-0">IsApprovalAllowed</label>
        </div>
        <div class="flex align-items-center gap-2">
          <p-checkbox
            formControlName="isUnapprovalAllowed"
            [binary]="true"
            inputId="isUnapprovalAllowed"
          />
          <label for="isUnapprovalAllowed" class="mb-0"
            >IsUnapprovalAllowed</label
          >
        </div>
        <div class="flex align-items-center gap-2">
          <p-checkbox
            formControlName="isRevisionAllowed"
            [binary]="true"
            inputId="isRevisionAllowed"
          />
          <label for="isRevisionAllowed" class="mb-0">IsRevisionAllowed</label>
        </div>
      </div> -->
      <!-- Action Buttons -->
      <div class="flex gap-2 justify-content-end mt-3 col-12 position-absolute bottom-0" style="left:0; border-top: 1px solid #DBDBDB; background-color:#fbfbfb; padding:16px 1.5rem; ">
        <p-button
          (onClick)="displayModal = false"
          label="Cancel"
          [outlined]="true"
          severity="warning"
        ></p-button>
        <p-button
          [loading]="saving"
          *ngIf="!editMode"
          (click)="save()"
          [disabled]="!rentalhouseform.valid"
          label="Save"
          [outlined]="true"
          severity="contrast"
        ></p-button>
        <p-button
          [loading]="saving"
          *ngIf="editMode"
          (click)="update()"
          [disabled]="!rentalhouseform.valid"
          label="Update"
          [outlined]="true"
          severity="contrast"
        ></p-button>
      </div>
    </form>
  </ng-container>
</p-dialog>
<!-- Toast and Confirm Dialog -->
<div>
  <p-toast />
  <p-confirmDialog class="cancel-modal"/>
</div>